<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>贪吃蛇</title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		.text {
			text-align: center;
			margin-top: 50px;
			color: red;
			font-size: 24px;
		}
		#canvas {
			display: block;
			margin:10px auto 0 ;
			border:1px solid #d3d3d3;
			background:#c5c6c8;
		}
	</style>
</head>
<body>
<h3 class="text">贪吃蛇游戏</h3>
<canvas id="canvas" width="500" height="500"></canvas>
<script>
	/*
	网页游戏开发：canvas   贪吃蛇
	通过改变坐标来实现
	 */
	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");// 创建2D绘图空间,画笔
	var r = [{x:10,y:9},{x:10,y:8}];//r数组表示贪吃蛇
	var co = 40;//表示前进的方向
	var e = null;//表示食物
	var stop = false;//控制开始暂停
	ctx.shadowBlur = 20;
	ctx.shadowColor = "black";
	function  onframe () {
		if (stop ||r[0].x<0 || r[0].x>=50 || r[0].y<0 || r[0].y>=50)return;
		//如果有食物，根据蛇前进方向是否吃到食物，并且将蛇数组中最后元素换到首部
		//将数组中最后一个元素换到首部
		if(e){
			if ((co==40&&r[0].x==e.x&&r[0].y+1==e.y)|| (co==38&&r[0].x==e.x&&r[0].y-1==e.y)||
					(co==37&&r[0].x-1==e.x&&r[0].y==e.y)|| (co==39&&r[0].x+1==e.x&&r[0].y+1==e.y)
			){
				r.unshift(e);
				e = null;
			}
		}
		r.unshift(r.pop());
		// 根据方向重新设定蛇数组元素的坐标,进行移动
		switch (co){
			case 37:
				r[0].x = r[1].x-1;
				r[0].y = r[1].y;
				break;
			case 38:
				r[0].x = r[1].x;
				r[0].y = r[1].y-1;
				break;
			case 39:
				r[0].x = r[1].x+1;
				r[0].y = r[1].y;
				break;
			case 40:
				r[0].x = r[1].x;
				r[0].y = r[1].y+1;
				break;
		}

	ctx.clearRect(0,0,500,500);//清除画布
	//绘制贪吃蛇
	for(var i=0;i<r.length;i++){
		ctx.fillRect(r[i].x*10,r[i].y*10,10,10);
	}
		// 如果没有食物，随机位置加食物
		if (e==null){
			e = {y:(Math.random()*50 >>> 0),x:(Math.random()*50 >>> 0)};
		}
		//如果有食物，来绘制食物
		if (e){
			ctx.fillRect(e.x*10,e.y*10,10,10);
		}
		if (r[0].x<0 || r[0].x>=50 || r[0].y<0 || r[0].y>=50){
			alert("Game over\n 真是完蛋才得了"+(r.length-2)+"分");
		}
	}
	setInterval(onframe,100);
	//写键盘的操作事件，控制方向
	document.onkeyup = function (event) {
		if (event.keyCode>=37&&event.keyCode<=40&&Math.abs(event.keyCode-co)!=2){
			co = event.keyCode;
		}else if(event.keyCode==32) {
			stop = !stop;
		}
	}
</script>
</body>
</html>